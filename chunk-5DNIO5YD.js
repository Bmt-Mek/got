import{b as G}from"./chunk-F5UEBNVW.js";import{d as E,l as at,m as rt,n as ot}from"./chunk-EHSRCE3Z.js";import{a as mt,b as lt,c as dt,d as pt,e as st,f as _t}from"./chunk-IJSEVG2A.js";import{u as J,v as Q}from"./chunk-N4DWY62P.js";import{e as S,i as Y,l as q,r as ct}from"./chunk-IFZUWJTO.js";import"./chunk-INVDN46R.js";import{a as W,b as X,c as Z,d as tt,f as et,g as it,h as nt}from"./chunk-JVBSLPCW.js";import{Ba as p,Eb as w,Fb as A,Hb as $,Ib as V,Ka as d,La as a,Lc as j,M as F,Ma as n,Mc as R,N as I,Na as D,Nc as z,Oc as L,Pa as b,Pb as N,Pc as H,Ra as u,Rb as U,Sa as l,aa as v,ba as C,bd as K,cb as M,eb as r,f as k,fb as _,gb as g,mb as f,nb as h,oa as o,sa as x,u as T,wa as P,y as B,z as O}from"./chunk-CJ3KH4JO.js";function ht(e,c){e&1&&D(0,"app-loading-spinner",5)}function xt(e,c){if(e&1){let t=b();a(0,"div",6)(1,"mat-icon"),r(2,"error"),n(),a(3,"h3"),r(4,"Character not found"),n(),a(5,"p"),r(6),n(),a(7,"div",7)(8,"button",8),u("click",function(){v(t);let m=l();return C(m.goBack())}),a(9,"mat-icon"),r(10,"arrow_back"),n(),r(11," Back to Characters "),n(),a(12,"button",9),u("click",function(){v(t);let m=l();return C(m.onRetry())}),a(13,"mat-icon"),r(14,"refresh"),n(),r(15," Try Again "),n()()()}if(e&2){let t=c.ngIf;o(6),_(t)}}function vt(e,c){if(e&1&&(a(0,"mat-card-subtitle"),r(1),n()),e&2){let t=l().ngIf;o(),_(t.culture)}}function Ct(e,c){if(e&1&&(a(0,"mat-chip",23),r(1),n()),e&2){let t=l().ngIf;o(),g(" ",t.gender," ")}}function ut(e,c){if(e&1&&(a(0,"div",24)(1,"span",25),r(2,"Born:"),n(),a(3,"span",26),r(4),n()()),e&2){let t=l().ngIf;o(4),_(t.born)}}function yt(e,c){if(e&1&&(a(0,"div",24)(1,"span",25),r(2,"Died:"),n(),a(3,"span",26),r(4),n()()),e&2){let t=l().ngIf;o(4),_(t.died)}}function kt(e,c){if(e&1&&(a(0,"div",24)(1,"span",25),r(2,"Culture:"),n(),a(3,"span",26),r(4),n()()),e&2){let t=l().ngIf;o(4),_(t.culture)}}function It(e,c){if(e&1&&(a(0,"div",24)(1,"span",25),r(2,"Gender:"),n(),a(3,"span",26),r(4),n()()),e&2){let t=l().ngIf;o(4),_(t.gender)}}function bt(e,c){if(e&1&&(a(0,"mat-chip",28),r(1),n()),e&2){let t=c.$implicit;d("matTooltip",t),o(),g(" ",t," ")}}function Mt(e,c){if(e&1&&(a(0,"mat-card",20)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),r(4,"military_tech"),n(),r(5," Titles "),n()(),a(6,"mat-card-content")(7,"mat-chip-set"),p(8,bt,2,2,"mat-chip",27),n()()()),e&2){let t=l().ngIf,i=l();o(8),d("ngForOf",i.getValidItems(t.titles))("ngForTrackBy",i.trackByTitle)}}function St(e,c){if(e&1&&(a(0,"mat-chip",30),r(1),n()),e&2){let t=c.$implicit;d("matTooltip",t),o(),g(" ",t," ")}}function Et(e,c){if(e&1&&(a(0,"mat-card",20)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),r(4,"face"),n(),r(5," Also Known As "),n()(),a(6,"mat-card-content")(7,"mat-chip-set"),p(8,St,2,2,"mat-chip",29),n()()()),e&2){let t=l().ngIf,i=l();o(8),d("ngForOf",i.getValidItems(t.aliases))("ngForTrackBy",i.trackByAlias)}}function Tt(e,c){if(e&1&&(a(0,"div",24)(1,"span",25),r(2,"Father:"),n(),a(3,"span",26),r(4),n()()),e&2){let t=l(2).ngIf,i=l();o(4),_(i.getCharacterNameFromUrl(t.father))}}function Bt(e,c){if(e&1&&(a(0,"div",24)(1,"span",25),r(2,"Mother:"),n(),a(3,"span",26),r(4),n()()),e&2){let t=l(2).ngIf,i=l();o(4),_(i.getCharacterNameFromUrl(t.mother))}}function Ot(e,c){if(e&1&&(a(0,"div",24)(1,"span",25),r(2,"Spouse:"),n(),a(3,"span",26),r(4),n()()),e&2){let t=l(2).ngIf,i=l();o(4),_(i.getCharacterNameFromUrl(t.spouse))}}function Ft(e,c){if(e&1&&(a(0,"mat-card",20)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),r(4,"family_restroom"),n(),r(5," Family "),n()(),a(6,"mat-card-content"),p(7,Tt,5,1,"div",21)(8,Bt,5,1,"div",21)(9,Ot,5,1,"div",21),n()()),e&2){let t=l().ngIf;o(7),d("ngIf",t.father),o(),d("ngIf",t.mother),o(),d("ngIf",t.spouse)}}function Pt(e,c){if(e&1&&(a(0,"mat-chip",34),r(1),n()),e&2){let t=c.$implicit,i=l(3);o(),g(" ",i.getHouseNameFromUrl(t)," ")}}function Dt(e,c){if(e&1&&(a(0,"p",35),r(1),n()),e&2){let t=l(2).ngIf;o(),g(" +",t.allegiances.length-5," more ")}}function wt(e,c){if(e&1&&(a(0,"mat-card",20)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),r(4,"shield"),n(),r(5," Allegiances "),n()(),a(6,"mat-card-content")(7,"div",31)(8,"mat-chip-set"),p(9,Pt,2,1,"mat-chip",32),n(),p(10,Dt,2,1,"p",33),n()()()),e&2){let t=l().ngIf,i=l();o(9),d("ngForOf",t.allegiances.slice(0,5))("ngForTrackBy",i.trackByAllegiance),o(),d("ngIf",t.allegiances.length>5)}}function At(e,c){if(e&1&&(a(0,"mat-chip",37),r(1),n()),e&2){let t=c.$implicit;o(),g(" ",t," ")}}function $t(e,c){if(e&1&&(a(0,"mat-card",20)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),r(4,"tv"),n(),r(5," TV Series Appearances "),n()(),a(6,"mat-card-content")(7,"mat-chip-set"),p(8,At,2,1,"mat-chip",36),n()()()),e&2){let t=l().ngIf,i=l();o(8),d("ngForOf",i.getValidItems(t.tvSeries))("ngForTrackBy",i.trackBySeason)}}function Vt(e,c){if(e&1&&(a(0,"mat-chip",39),r(1),n()),e&2){let t=c.$implicit;o(),g(" ",t," ")}}function Nt(e,c){if(e&1&&(a(0,"mat-card",20)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),r(4,"person"),n(),r(5," Played By "),n()(),a(6,"mat-card-content")(7,"mat-chip-set"),p(8,Vt,2,1,"mat-chip",38),n()()()),e&2){let t=l().ngIf,i=l();o(8),d("ngForOf",i.getValidItems(t.playedBy))("ngForTrackBy",i.trackByActor)}}function Ut(e,c){if(e&1&&(a(0,"mat-chip",43),r(1),n()),e&2){let t=c.$implicit,i=l(4);o(),g(" ",i.getBookNameFromUrl(t)," ")}}function jt(e,c){if(e&1&&(a(0,"div",41)(1,"h4"),r(2,"POV Character in:"),n(),a(3,"mat-chip-set"),p(4,Ut,2,1,"mat-chip",42),n()()),e&2){let t=l(2).ngIf,i=l();o(4),d("ngForOf",t.povBooks.slice(0,3))("ngForTrackBy",i.trackByBook)}}function Rt(e,c){if(e&1&&(a(0,"mat-chip",45),r(1),n()),e&2){let t=c.$implicit,i=l(4);o(),g(" ",i.getBookNameFromUrl(t)," ")}}function zt(e,c){if(e&1&&(a(0,"div",41)(1,"h4"),r(2,"Appears in:"),n(),a(3,"mat-chip-set"),p(4,Rt,2,1,"mat-chip",44),n()()),e&2){let t=l(2).ngIf,i=l();o(4),d("ngForOf",t.books.slice(0,3))("ngForTrackBy",i.trackByBook)}}function Lt(e,c){if(e&1&&(a(0,"mat-card",20)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),r(4,"book"),n(),r(5," Book Appearances "),n()(),a(6,"mat-card-content"),p(7,jt,5,2,"div",40)(8,zt,5,2,"div",40),n()()),e&2){let t=l().ngIf;o(7),d("ngIf",t.povBooks==null?null:t.povBooks.length),o(),d("ngIf",t.books==null?null:t.books.length)}}function Ht(e,c){if(e&1){let t=b();a(0,"div",10)(1,"div",11)(2,"button",12),u("click",function(){v(t);let m=l();return C(m.goBack())}),a(3,"mat-icon"),r(4,"arrow_back"),n(),r(5," Back to Characters "),n(),a(6,"button",13),f(7,"async"),f(8,"async"),u("click",function(){let m=v(t).ngIf,s=l();return C(s.onToggleFavorite(m))}),a(9,"mat-icon"),r(10),f(11,"async"),n()()(),a(12,"mat-card",14)(13,"mat-card-header")(14,"div",15)(15,"mat-icon"),r(16),n()(),a(17,"mat-card-title"),r(18),n(),p(19,vt,2,1,"mat-card-subtitle",16),n(),a(20,"mat-card-content")(21,"div",17)(22,"mat-chip-set")(23,"mat-chip"),r(24),n(),p(25,Ct,2,1,"mat-chip",18),n()()()(),a(26,"div",19)(27,"mat-card",20)(28,"mat-card-header")(29,"mat-card-title")(30,"mat-icon"),r(31,"info"),n(),r(32," Basic Information "),n()(),a(33,"mat-card-content"),p(34,ut,5,1,"div",21)(35,yt,5,1,"div",21)(36,kt,5,1,"div",21)(37,It,5,1,"div",21),n()(),p(38,Mt,9,2,"mat-card",22)(39,Et,9,2,"mat-card",22)(40,Ft,10,3,"mat-card",22)(41,wt,11,3,"mat-card",22)(42,$t,9,2,"mat-card",22)(43,Nt,9,2,"mat-card",22)(44,Lt,9,2,"mat-card",22),n()()}if(e&2){let t=c.ngIf,i=l();o(6),d("color",h(7,27,i.isFavorite$)?"warn":"primary")("matTooltip",h(8,29,i.isFavorite$)?"Remove from favorites":"Add to favorites"),o(4),_(h(11,31,i.isFavorite$)?"favorite":"favorite_border"),o(5),M("alive",i.isAlive(t))("dead",!i.isAlive(t)),o(),g(" ",i.isAlive(t)?"person":"person_off"," "),o(2),_(i.getDisplayName(t)),o(),d("ngIf",t.culture),o(4),M("alive-chip",i.isAlive(t))("dead-chip",!i.isAlive(t)),o(),g(" ",i.isAlive(t)?"Alive":"Deceased"," "),o(),d("ngIf",t.gender),o(9),d("ngIf",t.born),o(),d("ngIf",t.died),o(),d("ngIf",t.culture),o(),d("ngIf",t.gender),o(),d("ngIf",t.titles==null?null:t.titles.length),o(),d("ngIf",t.aliases==null?null:t.aliases.length),o(),d("ngIf",i.hasFamilyInfo(t)),o(),d("ngIf",t.allegiances==null?null:t.allegiances.length),o(),d("ngIf",t.tvSeries==null?null:t.tvSeries.length),o(),d("ngIf",t.playedBy==null?null:t.playedBy.length),o(),d("ngIf",(t.books==null?null:t.books.length)||(t.povBooks==null?null:t.povBooks.length))}}var xe=(()=>{let c=class c{constructor(i,m,s,gt,ft){this.route=i,this.router=m,this.store=s,this.snackBar=gt,this.charactersService=ft,this.destroy$=new k,this.characterId="",this.favoriteToggle$=new k,this.character$=this.store.select(at),this.isLoading$=this.store.select(rt),this.error$=this.store.select(ot),this.isFavorite$=this.character$.pipe(T(y=>!!y),F(y=>this.store.select(S(y.url))))}ngOnInit(){this.route.params.pipe(I(this.destroy$)).subscribe(i=>{this.characterId=i.id,this.characterId&&this.store.dispatch(E({id:this.characterId}))}),this.favoriteToggle$.pipe(B(300),I(this.destroy$)).subscribe(i=>{this.performFavoriteToggle(i)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onToggleFavorite(i){!i||!i.url||this.favoriteToggle$.next(i)}performFavoriteToggle(i){if(console.log("performFavoriteToggle called with character:",i),!i||!i.url){console.error("Invalid character data:",i),this.snackBar.open("Invalid character data","Close",{duration:2e3});return}console.log("Checking favorite status for URL:",i.url),this.store.select(S(i.url)).pipe(O(1)).subscribe({next:m=>{console.log("Current favorite status:",m);try{m?(console.log("Removing from favorites"),this.store.dispatch(q({characterUrl:i.url})),this.snackBar.open("Removed from favorites","Close",{duration:2e3})):(console.log("Adding to favorites"),this.store.dispatch(Y({character:i})),this.snackBar.open("Added to favorites","Close",{duration:2e3}))}catch(s){console.error("Error dispatching action:",s),this.snackBar.open("Error updating favorites","Close",{duration:2e3})}},error:m=>{console.error("Error checking favorite status:",m),this.snackBar.open("Error updating favorites","Close",{duration:2e3})}})}onRetry(){this.characterId&&this.store.dispatch(E({id:this.characterId}))}goBack(){this.router.navigate(["/characters"])}getDisplayName(i){return this.charactersService.getCharacterDisplayName(i)}isAlive(i){return this.charactersService.isCharacterAlive(i)}getValidItems(i){return i?i.filter(m=>m&&m.trim()!==""):[]}hasFamilyInfo(i){return!!(i.father||i.mother||i.spouse)}getCharacterNameFromUrl(i){return`Character ${i.split("/").pop()}`}getHouseNameFromUrl(i){return`House ${i.split("/").pop()}`}getBookNameFromUrl(i){let m={1:"A Game of Thrones",2:"A Clash of Kings",3:"A Storm of Swords",4:"A Feast for Crows",5:"A Dance with Dragons"},s=i.split("/").pop()||"";return m[s]||`Book ${s}`}trackByTitle(i,m){return m}trackByAlias(i,m){return m}trackByAllegiance(i,m){return m}trackBySeason(i,m){return m}trackByActor(i,m){return m}trackByBook(i,m){return m}};c.\u0275fac=function(m){return new(m||c)(x(N),x(U),x(K),x(J),x(ct))},c.\u0275cmp=P({type:c,selectors:[["app-character-detail"]],decls:8,vars:9,consts:[[1,"character-detail-page"],[1,"container"],["message","Loading character details...",4,"ngIf"],["class","error-message",4,"ngIf"],["class","character-content fade-in",4,"ngIf"],["message","Loading character details..."],[1,"error-message"],[1,"error-actions"],["mat-raised-button","","color","primary",3,"click"],["mat-button","",3,"click"],[1,"character-content","fade-in"],[1,"character-nav"],["mat-button","",1,"back-button",3,"click"],["mat-fab","",1,"favorite-fab",3,"click","color","matTooltip"],[1,"character-header"],["mat-card-avatar","",1,"character-avatar"],[4,"ngIf"],[1,"status-chips"],["class","gender-chip",4,"ngIf"],[1,"character-info-grid"],[1,"info-card"],["class","info-item",4,"ngIf"],["class","info-card",4,"ngIf"],[1,"gender-chip"],[1,"info-item"],[1,"info-label"],[1,"info-value"],["class","title-chip",3,"matTooltip",4,"ngFor","ngForOf","ngForTrackBy"],[1,"title-chip",3,"matTooltip"],["class","alias-chip",3,"matTooltip",4,"ngFor","ngForOf","ngForTrackBy"],[1,"alias-chip",3,"matTooltip"],[1,"allegiances-list"],["class","allegiance-chip",4,"ngFor","ngForOf","ngForTrackBy"],["class","more-items",4,"ngIf"],[1,"allegiance-chip"],[1,"more-items"],["class","tv-chip",4,"ngFor","ngForOf","ngForTrackBy"],[1,"tv-chip"],["class","actor-chip",4,"ngFor","ngForOf","ngForTrackBy"],[1,"actor-chip"],["class","book-section",4,"ngIf"],[1,"book-section"],["class","pov-book-chip",4,"ngFor","ngForOf","ngForTrackBy"],[1,"pov-book-chip"],["class","book-chip",4,"ngFor","ngForOf","ngForTrackBy"],[1,"book-chip"]],template:function(m,s){m&1&&(a(0,"div",0)(1,"div",1),p(2,ht,1,0,"app-loading-spinner",2),f(3,"async"),p(4,xt,16,1,"div",3),f(5,"async"),p(6,Ht,45,33,"div",4),f(7,"async"),n()()),m&2&&(o(2),d("ngIf",h(3,3,s.isLoading$)),o(2),d("ngIf",h(5,5,s.error$)),o(2),d("ngIf",h(7,7,s.character$)))},dependencies:[V,w,A,$,z,j,R,H,L,nt,W,it,Z,et,tt,X,_t,pt,st,G,Q,lt,mt,dt],styles:[".character-detail-page[_ngcontent-%COMP%]{min-height:100vh;padding:2rem 0}.character-content[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto}.character-nav[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.back-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.favorite-fab[_ngcontent-%COMP%]{position:fixed;top:50%;right:20px;z-index:1000;transform:translateY(-50%)}@media (max-width: 768px){.favorite-fab[_ngcontent-%COMP%]{position:static;transform:none}}.character-header[_ngcontent-%COMP%]{margin-bottom:2rem}.character-avatar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:80px;height:80px;border-radius:50%;background-color:#f5f5f5}.character-avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:2rem;width:2rem;height:2rem}.character-avatar[_ngcontent-%COMP%]   mat-icon.alive[_ngcontent-%COMP%]{color:#4caf50}.character-avatar[_ngcontent-%COMP%]   mat-icon.dead[_ngcontent-%COMP%]{color:#f44336}.status-chips[_ngcontent-%COMP%]{margin-top:1rem}.alive-chip[_ngcontent-%COMP%]{background-color:#e8f5e8!important;color:#2e7d32!important}.dead-chip[_ngcontent-%COMP%]{background-color:#ffebee!important;color:#c62828!important}.gender-chip[_ngcontent-%COMP%]{background-color:#e3f2fd!important;color:#1565c0!important}.character-info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1.5rem}@media (min-width: 768px){.character-info-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (min-width: 1024px){.character-info-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}.info-card[_ngcontent-%COMP%]{height:fit-content}.info-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:1.1rem}.info-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:.75rem;padding:.5rem 0;border-bottom:1px solid #eee}.info-item[_ngcontent-%COMP%]:last-child{border-bottom:none;margin-bottom:0}.info-label[_ngcontent-%COMP%]{font-weight:500;color:#666}.info-value[_ngcontent-%COMP%]{text-align:right;flex:1;margin-left:1rem}.title-chip[_ngcontent-%COMP%]{background-color:#fff3e0!important;color:#ef6c00!important;margin-bottom:.5rem}.alias-chip[_ngcontent-%COMP%]{background-color:#f3e5f5!important;color:#7b1fa2!important;margin-bottom:.5rem}.allegiance-chip[_ngcontent-%COMP%]{background-color:#e8f5e8!important;color:#2e7d32!important;margin-bottom:.5rem}.tv-chip[_ngcontent-%COMP%]{background-color:#e3f2fd!important;color:#1565c0!important;margin-bottom:.5rem}.actor-chip[_ngcontent-%COMP%]{background-color:#fce4ec!important;color:#c2185b!important;margin-bottom:.5rem}.book-section[_ngcontent-%COMP%]{margin-bottom:1rem}.book-section[_ngcontent-%COMP%]:last-child{margin-bottom:0}.book-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;margin-bottom:.5rem;color:#666}.pov-book-chip[_ngcontent-%COMP%]{background-color:#fff8e1!important;color:#f57c00!important;margin-bottom:.5rem}.book-chip[_ngcontent-%COMP%]{background-color:#f1f8e9!important;color:#558b2f!important;margin-bottom:.5rem}.more-items[_ngcontent-%COMP%]{font-size:.875rem;color:#666;margin-top:.5rem;margin-bottom:0}.error-message[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem;color:#666}.error-message[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:4rem;width:4rem;height:4rem;margin-bottom:1rem;color:#f44336}.error-message[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:1rem;color:#f44336}.error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:2rem;max-width:400px;margin-left:auto;margin-right:auto}.error-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1rem;flex-wrap:wrap}"]});let e=c;return e})();export{xe as CharacterDetailComponent};
