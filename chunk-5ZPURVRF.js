import{a as J,b as j,c as T,d as X,e as q,f as Q,g as bt,h as $t,i as Ot,j as wt}from"./chunk-E5OBEZHR.js";import{f as L,g as U,h as G,i as H,j as V,k as z,l as K,m as Y,n as _,o as xt,q as Mt,r as kt,s as Dt}from"./chunk-KOZXLSCX.js";import{e as b,f as I,g as $,h as O,i as R,j as w,k,l as D,m as P,n as B,o as N,p as Tt}from"./chunk-DYCMOP4I.js";import{$c as jt,A as mt,B as vt,D as gt,E as et,F as At,M as g,P as S,Rb as Ct,Rc as yt,T as A,V as F,W as d,Wc as It,X as E,Xc as Rt,Y as Ft,Z as Et,a as s,b as a,bd as M,e as lt,f as dt,fd as c,ga as St,gd as C,m as v,p as l,q as Z,t as tt,u as x,w as h,y as ht,z as pt}from"./chunk-TGLPQRFT.js";var Kt={dispatch:!0,functional:!1,useEffectsErrorHandler:!0},W="__@ngrx/effects_create__";function p(t,e={}){let n=e.functional?t:t(),r=s(s({},Kt),e);return Object.defineProperty(n,W,{value:r}),n}function Yt(t){return Object.getOwnPropertyNames(t).filter(r=>t[r]&&t[r].hasOwnProperty(W)?t[r][W].hasOwnProperty("dispatch"):!1).map(r=>{let i=t[r][W];return s({propertyName:r},i)})}function _t(t){return Yt(t)}function Pt(t){return Object.getPrototypeOf(t)}function Jt(t){return!!t.constructor&&t.constructor.name!=="Object"&&t.constructor.name!=="Function"}function Bt(t){return typeof t=="function"}function Xt(t){return t.filter(Bt)}function qt(t,e,n){let r=Pt(t),f=!!r&&r.constructor.name!=="Object"?r.constructor.name:null,o=_t(t).map(({propertyName:u,dispatch:Ht,useEffectsErrorHandler:Vt})=>{let ft=typeof t[u]=="function"?t[u]():t[u],ut=Vt?n(ft,e):ft;return Ht===!1?ut.pipe(mt()):ut.pipe(At()).pipe(l(zt=>({effect:t[u],notification:zt,propertyName:u,sourceName:f,sourceInstance:t})))});return tt(...o)}var Qt=10;function Nt(t,e,n=Qt){return t.pipe(h(r=>(e&&e.handleError(r),n<=1?t:Nt(t,e,n-1))))}var y=(()=>{let e=class e extends lt{constructor(r){super(),r&&(this.source=r)}lift(r){let i=new e;return i.source=this,i.operator=r,i}};e.\u0275fac=function(i){return new(i||e)(d(jt))},e.\u0275prov=A({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function m(...t){return x(e=>t.some(n=>typeof n=="string"?n===e.type:n.type===e.type))}var ke=new F("@ngrx/effects Internal Root Guard"),De=new F("@ngrx/effects User Provided Effects"),Pe=new F("@ngrx/effects Internal Root Effects"),Be=new F("@ngrx/effects Internal Root Effects Instances"),Ne=new F("@ngrx/effects Internal Feature Effects"),Le=new F("@ngrx/effects Internal Feature Effects Instance Groups"),Wt=new F("@ngrx/effects Effects Error Handler",{providedIn:"root",factory:()=>Nt}),Zt="@ngrx/effects/init",te=yt(Zt);function ee(t,e){if(t.notification.kind==="N"){let n=t.notification.value;!re(n)&&e.handleError(new Error(`Effect ${oe(t)} dispatched an invalid action: ${ie(n)}`))}}function re(t){return typeof t!="function"&&t&&t.type&&typeof t.type=="string"}function oe({propertyName:t,sourceInstance:e,sourceName:n}){let r=typeof e[t]=="function";return!!n?`"${n}.${String(t)}${r?"()":""}"`:`"${String(t)}()"`}function ie(t){try{return JSON.stringify(t)}catch{return t}}var se="ngrxOnIdentifyEffects";function ae(t){return ot(t,se)}var ce="ngrxOnRunEffects";function ne(t){return ot(t,ce)}var fe="ngrxOnInitEffects";function ue(t){return ot(t,fe)}function ot(t,e){return t&&e in t&&typeof t[e]=="function"}var Lt=(()=>{let e=class e extends dt{constructor(r,i){super(),this.errorHandler=r,this.effectsErrorHandler=i}addEffects(r){this.next(r)}toActions(){return this.pipe(et(r=>Jt(r)?Pt(r):r),Z(r=>r.pipe(et(le))),Z(r=>{let i=r.pipe(gt(o=>de(this.errorHandler,this.effectsErrorHandler)(o)),l(o=>(ee(o,this.errorHandler),o.notification)),x(o=>o.kind==="N"&&o.value!=null),vt()),f=r.pipe(pt(1),x(ue),l(o=>o.ngrxOnInitEffects()));return tt(i,f)}))}};e.\u0275fac=function(i){return new(i||e)(d(St),d(Wt))},e.\u0275prov=A({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function le(t){return ae(t)?t.ngrxOnIdentifyEffects():""}function de(t,e){return n=>{let r=qt(n,t,e);return ne(n)?n.ngrxOnRunEffects(r):r}}var he=(()=>{let e=class e{get isStarted(){return!!this.effectsSubscription}constructor(r,i){this.effectSources=r,this.store=i,this.effectsSubscription=null}start(){this.effectsSubscription||(this.effectsSubscription=this.effectSources.toActions().subscribe(this.store))}ngOnDestroy(){this.effectsSubscription&&(this.effectsSubscription.unsubscribe(),this.effectsSubscription=null)}};e.\u0275fac=function(i){return new(i||e)(d(Lt),d(M))},e.\u0275prov=A({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Ue(...t){let e=t.flat(),n=Xt(e);return Ft([n,Et(()=>{E(It),E(Rt,{optional:!0});let r=E(he),i=E(Lt),f=!r.isStarted;f&&r.start();for(let o of e){let u=Bt(o)?E(o):o;i.addEffects(u)}f&&E(M).dispatch(te())})])}var Ye=(()=>{let e=class e{constructor(r,i){this.actions$=r,this.charactersService=i,this.loadCharacters$=p(()=>this.actions$.pipe(m(J),g(({page:f=1,searchParams:o})=>this.charactersService.getCharacters(f,o).pipe(l(u=>j({characters:u.data,total:u.total,page:u.page})),h(u=>v(T({error:u.message||"Failed to load characters"}))))))),this.loadCharacterById$=p(()=>this.actions$.pipe(m(X),g(({id:f})=>this.charactersService.getCharacterById(f).pipe(l(o=>q({character:o})),h(o=>v(Q({error:o.message||"Failed to load character"}))))))),this.searchCharacters$=p(()=>this.actions$.pipe(m(bt),ht(300),g(({searchTerm:f})=>this.charactersService.searchCharacters(f).pipe(l(o=>j({characters:o.data,total:o.total,page:1})),h(o=>v(T({error:o.message||"Failed to search characters"})))))))}};e.\u0275fac=function(i){return new(i||e)(d(y),d(kt))},e.\u0275prov=A({token:e,factory:e.\u0275fac});let t=e;return t})();var We=(()=>{let e=class e{constructor(r,i){this.actions$=r,this.favoritesService=i,this.loadFavorites$=p(()=>this.actions$.pipe(m(L),g(()=>this.favoritesService.getFavorites().pipe(l(f=>U({favorites:f})),h(f=>v(G({error:f.message||"Failed to load favorites"}))))))),this.addToFavorites$=p(()=>this.actions$.pipe(m(H),S(f=>console.log("AddToFavorites effect triggered:",f)),g(({character:f})=>this.favoritesService.addToFavorites(f).pipe(S(()=>console.log("Add to favorites service completed successfully")),l(()=>(console.log("Dispatching addToFavoritesSuccess"),V({character:f}))),h(o=>(console.error("Add to favorites service error:",o),v(z({error:o.message||"Failed to add to favorites"})))))))),this.removeFromFavorites$=p(()=>this.actions$.pipe(m(K),g(({characterUrl:f})=>this.favoritesService.removeFromFavorites(f).pipe(l(()=>Y({characterUrl:f})),h(o=>v(_({error:o.message||"Failed to remove from favorites"})))))))}};e.\u0275fac=function(i){return new(i||e)(d(y),d(Dt))},e.\u0275prov=A({token:e,factory:e.\u0275fac});let t=e;return t})();var sr=(()=>{let e=class e{constructor(r,i,f){this.actions$=r,this.authService=i,this.router=f,this.login$=p(()=>this.actions$.pipe(m(b),g(({credentials:o})=>this.authService.login(o).pipe(l(u=>I({authResponse:u})),h(u=>v($({error:u.message||"Login failed"}))))))),this.register$=p(()=>this.actions$.pipe(m(O),g(({userData:o})=>this.authService.register(o).pipe(l(u=>R({authResponse:u})),h(u=>v(w({error:u.message||"Registration failed"}))))))),this.loginSuccess$=p(()=>this.actions$.pipe(m(I,R),S(()=>{this.router.navigate(["/characters"])})),{dispatch:!1}),this.logout$=p(()=>this.actions$.pipe(m(k),S(()=>{this.authService.logout(),this.router.navigate(["/"])}),l(()=>D()))),this.checkAuthStatus$=p(()=>this.actions$.pipe(m(P),g(()=>this.authService.getCurrentUser().pipe(l(o=>B({user:o})),h(()=>v(N()))))))}};e.\u0275fac=function(i){return new(i||e)(d(y),d(Mt),d(Ct))},e.\u0275prov=A({token:e,factory:e.\u0275fac});let t=e;return t})();var Ut={characters:[],selectedCharacter:null,loading:!1,error:null,searchParams:null,currentPage:1,totalPages:0,total:0},st=C(Ut,c(J,t=>a(s({},t),{loading:!0,error:null})),c(j,(t,{characters:e,total:n,page:r})=>a(s({},t),{characters:e,total:n,currentPage:r,totalPages:Math.ceil(n/10),loading:!1,error:null})),c(T,(t,{error:e})=>a(s({},t),{loading:!1,error:e})),c(X,t=>a(s({},t),{loading:!0,error:null})),c(q,(t,{character:e})=>a(s({},t),{selectedCharacter:e,loading:!1,error:null})),c(Q,(t,{error:e})=>a(s({},t),{loading:!1,error:e})),c($t,(t,{searchParams:e})=>a(s({},t),{searchParams:e,currentPage:1})),c(Ot,t=>a(s({},t),{searchParams:null,currentPage:1})),c(wt,(t,{page:e})=>a(s({},t),{currentPage:e})));var Gt={favorites:[],loading:!1,error:null},at=C(Gt,c(L,t=>a(s({},t),{loading:!0,error:null})),c(U,(t,{favorites:e})=>a(s({},t),{favorites:e,loading:!1,error:null})),c(G,(t,{error:e})=>a(s({},t),{loading:!1,error:e})),c(H,t=>a(s({},t),{loading:!0,error:null})),c(V,(t,{character:e})=>a(s({},t),{favorites:[...t.favorites,e],loading:!1,error:null})),c(z,(t,{error:e})=>a(s({},t),{loading:!1,error:e})),c(K,t=>a(s({},t),{loading:!0,error:null})),c(Y,(t,{characterUrl:e})=>a(s({},t),{favorites:t.favorites.filter(n=>n.url!==e),loading:!1,error:null})),c(_,(t,{error:e})=>a(s({},t),{loading:!1,error:e})),c(xt,t=>a(s({},t),{favorites:[],loading:!1,error:null})));var ct={user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null},nt=C(ct,c(b,O,t=>a(s({},t),{isLoading:!0,error:null})),c(I,R,(t,{authResponse:e})=>a(s({},t),{user:e.user,token:e.token,isAuthenticated:!0,isLoading:!1,error:null})),c($,w,(t,{error:e})=>a(s({},t),{isLoading:!1,error:e})),c(k,D,()=>s({},ct)),c(P,t=>a(s({},t),{isLoading:!0})),c(B,(t,{user:e})=>a(s({},t),{user:e,isAuthenticated:!0,isLoading:!1})),c(N,t=>a(s({},t),{isLoading:!1,isAuthenticated:!1})),c(Tt,t=>a(s({},t),{error:null})));var Fr={characters:st,favorites:at,auth:nt};export{Ue as a,Ye as b,We as c,sr as d,Fr as e};
